"use strict";(self.webpackChunkfrontend_app=self.webpackChunkfrontend_app||[]).push([[2407],{12407:(e,t,n)=>{n.r(t),n.d(t,{default:()=>G});var o=n(47313),s=n(79536);const l={searchContainer:"styles_searchContainer__z7WgP",searchInput:"styles_searchInput__mm4w3",containerDetailSolution:"styles_containerDetailSolution__et12E",stickyBack:"styles_stickyBack__ageI3",backButton:"styles_backButton__Q57nc",backIcon:"styles_backIcon__k3QZq",solutionContainer:"styles_solutionContainer__Q2Rdo",userInfo:"styles_userInfo__xcSXt",imgAvatar:"styles_imgAvatar__HR+9r",nameInfoContainer:"styles_nameInfoContainer__7PYuA",solutionButton:"styles_solutionButton__KztC8",solutionIcon:"styles_solutionIcon__-N-Sw",upVote:"styles_upVote__SaJ5r",view:"styles_view__WFl7f",calendar:"styles_calendar__m57yT",tagLanguageSolution:"styles_tagLanguageSolution__YWOMZ",item:"styles_item__6FBz8",commentContainer:"styles_commentContainer__rmZhz",commentTitleContainer:"styles_commentTitleContainer__bpTPv",commentTitle:"styles_commentTitle__-FJn0",commentIcon:"styles_commentIcon__RzMxA",commentBox:"styles_commentBox__toj2a",textArea:"styles_textArea__SxuVi",commentButton:"styles_commentButton__Nw4-c",commentList:"styles_commentList__tligR",commentItem:"styles_commentItem__6r0wy",commentInfoUser:"styles_commentInfoUser__TEVE7",commentContent:"styles_commentContent__jgLGD",commentName:"styles_commentName__GTHZK",commentText:"styles_commentText__pdg+v",commentAction:"styles_commentAction__RCa8g",reply:"styles_reply__IPxig",stickyUpvote:"styles_stickyUpvote__mbKRu",upvoteButton:"styles_upvoteButton__afLv3",markdown:"styles_markdown__OBpHz"};var i=n(14647),a=n(42832),c=n(47131),r=n(16759),m=n(51405),d=n(19536),u=n(48119),_=n(85281),h=n(74312),v=n(80007),x=n(38037),j=n(10259),g=n(39276),Z=n(627),y=n(2126),p=n(11001),b=n(33223),f=n(86618),N=n(19187),k=n(47477),C=n(75590),I=n(51928),S=n(8344),w=n(60191),T=n(23885),B=n(15162),A=n(75627),z=n(62563),L=n(21933),R=n(22665),U=n(1229),O=n(58467),P=n(90469),E=n(29878),M=n(74654),D=n.n(M),V=n(46417);const F=(e,t)=>{try{return void 0===e?e:(0,B.J$)(e,t)}catch(n){return console.error(n),e}};function G(e){var t,n,B,M,G,H,K,q,J,Q,W,X,Y,$,ee;let{handleSolutionDetail:te,selectedSolutionId:ne}=e;const{t:oe}=(0,C.$G)(),se=L.Ry().shape({comment:L.Z_().required("".concat(oe("detail_problem_discussion_detail_comment")," ").concat(oe("common_cannot_be_blank"))).test("not-blank","".concat(oe("detail_problem_discussion_detail_comment")," ").concat(oe("common_cannot_be_blank")),(e=>void 0!==e&&e.trim().length>0))}),le=(0,I.T)(),ie=(0,U.Z)(),ae=(0,O.s0)(),[ce,re]=(0,o.useState)(null),{problemId:me,courseId:de,lessonId:ue}=(0,O.UO)(),[_e,he]=(0,o.useState)(!1),ve=10,[xe,je]=(0,o.useState)(0),[ge,Ze]=(0,o.useState)(1),[ye,pe]=(0,o.useState)(0),[be,fe]=(0,o.useState)([]),[Ne,ke]=(0,o.useState)(!0),{register:Ce,control:Ie,handleSubmit:Se,setValue:we}=(0,A.cI)({defaultValues:{comment:new Array(ve).fill({value:"",id:""})}}),{fields:Te}=(0,A.Dq)({name:"comment",control:Ie}),Be=e=>{const t=Me.findIndex((e=>!0===e));t>-1&&t<be.length&&w.T.editComment(e.comment[t].id,e.comment[t].value).then((e=>{Xe(),qe()}))},[Ae,ze]=o.useState(null),Le=Boolean(Ae),[Re,Ue]=o.useState(null),Oe=Boolean(Re),[Pe,Ee]=(0,o.useState)(new Array(ve).fill(null)),[Me,De]=(0,o.useState)(new Array(ve).fill(!1)),Ve=Pe.map((e=>Boolean(e))),[Fe,Ge]=(0,o.useState)(!1),He=()=>{ze(null)},Ke=e=>{let t=D()(Pe);t[e]=null,Ee(t)},qe=()=>{let e=new Array(ve).fill(!1);De(e)};(0,o.useEffect)((()=>{ne&&(le((0,S.K4)(!0)),w.T.getDetailSharedSolution(ne).then((e=>{re(e)})).catch((e=>console.log(e))).finally((()=>{le((0,S.K4)(!1))})))}),[]),(0,o.useEffect)((()=>{Xe()}),[Ne,xe]);const{register:Je,handleSubmit:Qe,formState:{errors:We}}=(0,A.cI)({resolver:(0,z.X)(se)}),Xe=()=>{ne&&(he(!0),w.T.getRootComments(ne,xe,ve,Ne).then((e=>{var t;Ze(e.totalPages),pe(e.totalItems),fe(e.comments),null===(t=e.comments)||void 0===t||t.forEach(((e,t)=>{we("comment.".concat(t,".value"),e.content),we("comment.".concat(t,".id"),e.id)}))})).catch((e=>console.log(e))).then((()=>{he(!1)})))},Ye=(0,o.useRef)(null),{height:$e}=(0,k.Z)({ref:Ye});return(0,V.jsxs)(s.Z,{className:l.containerDetailSolution,children:[(0,V.jsxs)(s.Z,{className:l.stickyBack,ref:Ye,children:[(0,V.jsxs)(a.Z,{direction:"row",justifyContent:"space-between",children:[(0,V.jsxs)(s.Z,{onClick:te,className:l.backButton,children:[(0,V.jsx)(i.Z,{className:l.backIcon}),(0,V.jsx)("span",{"translation-key":"common_back",children:oe("common_back")})]}),ie.loggedUser.userId===(null===ce||void 0===ce?void 0:ce.user.id)&&(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(c.Z,{id:"edit-solution-button","aria-controls":Oe?"edit-solution-menu":void 0,"aria-haspopup":"true","aria-expanded":Oe?"true":void 0,onClick:e=>{Ue(e.currentTarget)},children:(0,V.jsx)(f.Z,{})}),(0,V.jsxs)(r.Z,{id:"edit-solution-menu","aria-labelledby":"edit-solution-button",anchorEl:Re,open:Oe,onClose:()=>{Ue(null)},anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:[(0,V.jsx)(m.Z,{onClick:()=>{me&&ae(P._.user.problem.solution.share.replace(":problemId",me),{state:{content:null===ce||void 0===ce?void 0:ce.content,title:null===ce||void 0===ce?void 0:ce.title,tags:null===ce||void 0===ce?void 0:ce.tags,edit:!0,solutionId:null===ce||void 0===ce?void 0:ce.sharedSolutionId}})},children:oe("common_edit")}),(0,V.jsx)(m.Z,{onClick:()=>Ge(!0),sx:{color:"red"},children:oe("common_remove")})]}),(0,V.jsx)(E.Z,{isOpen:Fe,title:oe("dialog_confirm_delete_title"),description:oe("dialog_confirm_delete_shared_solution"),onCancel:()=>{Ge(!1)},onDelete:()=>{null!==ce&&void 0!==ce&&ce.sharedSolutionId&&w.T.deleteSharedSolution(ce.sharedSolutionId).then((e=>{te()})).catch((e=>console.log(e))),Ge(!1)}})]})]}),(0,V.jsx)(d.Z,{})]}),(0,V.jsx)(s.Z,{className:l.solutionContainer,style:{height:"calc(100% - ".concat($e,"px)")},children:ce&&(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(s.Z,{className:l.solutionTitle,children:(0,V.jsx)(x.Z,{children:ce.title})}),(0,V.jsxs)(s.Z,{className:l.userInfo,children:[(0,V.jsx)(s.Z,{className:l.avatar,children:(0,V.jsx)(u.Z,{sx:{bgcolor:"".concat((0,R.M)("".concat(null===(t=ce.user)||void 0===t?void 0:t.firstName," ").concat(null===(n=ce.user)||void 0===n?void 0:n.lastName)))},alt:null===(B=ce.user)||void 0===B?void 0:B.firstName,src:null===(M=ce.user)||void 0===M?void 0:M.avatarUrl,children:null===(G=ce.user)||void 0===G?void 0:G.firstName.charAt(0)})}),(0,V.jsxs)(s.Z,{className:l.nameInfoContainer,children:[(0,V.jsx)(s.Z,{className:l.name,children:"vi"===T.ZP.language?"".concat(null!==(H=null===(K=ce.user)||void 0===K?void 0:K.lastName)&&void 0!==H?H:""," ").concat(null!==(q=null===(J=ce.user)||void 0===J?void 0:J.firstName)&&void 0!==q?q:""):"".concat(null!==(Q=null===(W=ce.user)||void 0===W?void 0:W.firstName)&&void 0!==Q?Q:""," ").concat(null!==(X=null===(Y=ce.user)||void 0===Y?void 0:Y.lastName)&&void 0!==X?X:"")}),(0,V.jsxs)(s.Z,{className:l.solutionButton,children:[(0,V.jsxs)(s.Z,{className:l.view,children:[(0,V.jsx)(j.G,{icon:g.Mdf,className:l.solutionIcon}),(0,V.jsx)(s.Z,{className:l.viewNumber,children:ce.totalView})]}),(0,V.jsxs)(s.Z,{className:l.calendar,children:[(0,V.jsx)(j.G,{icon:g.fT7,className:l.solutionIcon}),(0,V.jsx)(s.Z,{className:l.calendarNumber,children:null!==($=F(ce.createdAt,T.ZP.language))&&void 0!==$?$:""})]})]})]})]}),(0,V.jsx)(s.Z,{className:l.tagLanguageSolution,children:ce.tags.map((e=>(0,V.jsx)(s.Z,{className:l.item,children:e.name},e.id)))}),(0,V.jsx)(s.Z,{"data-color-mode":"light",children:(0,V.jsx)(N.ZP.Markdown,{source:null!==(ee=ce.content)&&void 0!==ee?ee:"",className:l.markdown})}),(0,V.jsxs)(s.Z,{className:l.commentContainer,children:[(0,V.jsxs)(s.Z,{className:l.commentTitleContainer,children:[(0,V.jsxs)(s.Z,{className:l.commentTitle,children:[(0,V.jsx)(j.G,{icon:g.lXL,className:l.commentIcon}),(0,V.jsx)(s.Z,{className:l.commentNumber,"translation-key":"detail_problem_discussion_detail_comment_count",children:oe("detail_problem_discussion_detail_comment_count",{commentNumber:ye})})]}),(0,V.jsxs)(s.Z,{className:l.filterComment,children:[(0,V.jsx)(b.Z,{id:"newest-button",onClick:e=>{ze(e.currentTarget)},sx:{textTransform:"none"},children:(0,V.jsx)(v.Z,{"translation-key":Ne?"detail_problem_discussion_filter_newest":"detail_problem_discussion_filter_oldest",children:"".concat(oe("common_filter_by"),": ").concat(oe(Ne?"detail_problem_discussion_filter_newest":"detail_problem_discussion_filter_oldest"))})}),(0,V.jsxs)(r.Z,{id:"newest-menu","aria-labelledby":"newest-button",anchorEl:Ae,open:Le,onClose:He,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:[(0,V.jsx)(m.Z,{onClick:()=>{ke(!0),He()},children:oe("detail_problem_discussion_filter_newest")}),(0,V.jsx)(m.Z,{onClick:()=>{ke(!1),He()},children:oe("detail_problem_discussion_filter_oldest")})]})]})]}),(0,V.jsx)(s.Z,{className:l.commentBox,children:(0,V.jsxs)("form",{onSubmit:Qe((e=>{null!==ne&&w.T.createComment({sharedSolutionId:ne,content:e.comment}).then((e=>{Xe()})).catch((e=>{console.log(e)}))})),children:[(0,V.jsx)(p.u,{"aria-label":"empty textarea","translation-key":"detail_problem_discussion_your_comment",placeholder:oe("detail_problem_discussion_your_comment"),className:l.textArea,minRows:5,...Je("comment"),"aria-invalid":!!We.comment}),(0,V.jsx)(b.Z,{type:"submit",variant:"contained",className:l.commentButton,"translation-key":"detail_problem_discussion_detail_comment",children:oe("detail_problem_discussion_detail_comment")})]})}),We.comment&&(0,V.jsx)(v.Z,{colorname:"--red-error",children:We.comment.message}),(0,V.jsx)(s.Z,{className:l.commentList,children:(0,V.jsxs)(s.Z,{className:l.commentItem,children:[_e&&(0,V.jsx)(a.Z,{alignItems:"center",marginTop:1,children:(0,V.jsx)(_.Z,{})}),!_e&&be.map(((e,t)=>{var n,o,i,_,h,v,x,j,g,N,k,C,I;return(0,V.jsxs)("form",{onSubmit:Se(Be),children:[(0,V.jsxs)(s.Z,{className:l.commentInfo,children:[(0,V.jsxs)(a.Z,{direction:"row",justifyContent:"space-between",children:[(0,V.jsxs)(s.Z,{className:l.commentInfoUser,children:[(0,V.jsx)(u.Z,{sx:{bgcolor:"".concat((0,R.M)("".concat(null===(n=e.user)||void 0===n?void 0:n.firstName," ").concat(null===(o=e.user)||void 0===o?void 0:o.lastName)))},alt:null===(i=e.user)||void 0===i?void 0:i.firstName,src:null===(_=e.user)||void 0===_?void 0:_.avatarUrl,children:null===(h=e.user)||void 0===h?void 0:h.firstName.charAt(0)}),(0,V.jsx)(s.Z,{className:l.commentName,children:"vi"===T.ZP.language?"".concat(null!==(v=null===(x=e.user)||void 0===x?void 0:x.lastName)&&void 0!==v?v:""," ").concat(null!==(j=null===(g=ce.user)||void 0===g?void 0:g.firstName)&&void 0!==j?j:""):"".concat(null!==(N=null===(k=e.user)||void 0===k?void 0:k.firstName)&&void 0!==N?N:""," ").concat(null!==(C=null===(I=e.user)||void 0===I?void 0:I.lastName)&&void 0!==C?C:"")})]}),ie.loggedUser.userId===(null===ce||void 0===ce?void 0:ce.user.id)&&(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(c.Z,{id:"edit-solution-button-".concat(e.id),"aria-controls":Ve[t]?"edit-solution-menu-".concat(e.id):void 0,"aria-haspopup":"true","aria-expanded":Ve[t]?"true":void 0,onClick:e=>{((e,t)=>{let n=D()(Pe);n[t]=e.currentTarget,Ee(n)})(e,t)},children:(0,V.jsx)(f.Z,{})}),(0,V.jsxs)(r.Z,{id:"edit-solution-menu-".concat(e.id),"aria-labelledby":"edit-solution-button-".concat(e.id),anchorEl:Pe[t],open:Ve[t],onClose:()=>Ke(t),anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:[(0,V.jsx)(m.Z,{onClick:()=>(e=>{Ke(e);let t=new Array(ve).fill(!1);t[e]=!0,De(t)})(t),children:oe("common_edit")}),(0,V.jsx)(m.Z,{onClick:()=>(e=>{e>-1&&e<be.length&&w.T.deleteComment(be[e].id).then((e=>{Xe()})),Ke(e)})(t),sx:{color:"red"},children:oe("common_remove")})]})]})]}),(0,V.jsxs)(s.Z,{className:l.commentText,children:[!Me[t]&&(0,V.jsx)(Z.U,{children:e.content,remarkPlugins:[y.Z]}),Me[t]&&(0,V.jsxs)(s.Z,{className:l.commentBox,children:[(0,V.jsx)(p.u,{...Ce("comment.".concat(t,".value")),"aria-label":"empty textarea","translation-key":"detail_problem_discussion_your_comment",placeholder:oe("detail_problem_discussion_your_comment"),className:l.textArea,minRows:5,"aria-invalid":!!We.comment},Te[t].id),(0,V.jsxs)(a.Z,{direction:"row",justifyContent:"flex-end",spacing:1,children:[(0,V.jsx)(b.Z,{type:"submit",variant:"contained",sx:{textTransform:"none",backgroundColor:"green","&:hover":{backgroundColor:"green"}},"translation-key":"common_edit",children:oe("common_edit")}),(0,V.jsx)(b.Z,{variant:"contained",sx:{textTransform:"none",backgroundColor:"red","&:hover":{backgroundColor:"red"}},"translation-key":"common_close",onClick:qe,children:oe("common_close")})]})]})]})]},e.id),(0,V.jsx)(d.Z,{})]})})),(0,V.jsx)(a.Z,{alignItems:"center",children:(0,V.jsx)(h.Z,{count:ge,onChange:(e,t)=>{je(t-1)},page:xe+1})})]})})]})]})})]})}},14647:(e,t,n)=>{var o=n(64836);t.Z=void 0;var s=o(n(45045)),l=n(46417);t.Z=(0,s.default)((0,l.jsx)("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20z"}),"ArrowBack")},86618:(e,t,n)=>{var o=n(64836);t.Z=void 0;var s=o(n(45045)),l=n(46417);t.Z=(0,s.default)((0,l.jsx)("path",{d:"M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2"}),"MoreHoriz")}}]);