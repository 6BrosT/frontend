"use strict";(self.webpackChunkfrontend_app=self.webpackChunkfrontend_app||[]).push([[3194],{43194:(e,r,t)=>{t.r(r),t.d(r,{default:()=>h});class o extends Error{}function n(e){let r=e.replace(/-/g,"+").replace(/_/g,"/");switch(r.length%4){case 0:break;case 2:r+="==";break;case 3:r+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return function(e){return decodeURIComponent(atob(e).replace(/(.)/g,((e,r)=>{let t=r.charCodeAt(0).toString(16).toUpperCase();return t.length<2&&(t="0"+t),"%"+t})))}(r)}catch(t){return atob(r)}}o.prototype.name="InvalidTokenError";var a=t(47313),c=t(65537),s=t(58467),l=t(33117),i=t(8344),f=t(90469),g=t(5818),m=t(46417);const h=()=>{const e=(0,c.v9)(l.HF),r=(0,c.v9)(l.OA),t=(0,c.v9)(l.vz),h=localStorage.getItem("access_token"),p=localStorage.getItem("refresh_token"),u=(0,c.I0)(),d=(0,s.s0)(),k=e=>{if(!e)return!0;try{const r=function(e,r){if("string"!==typeof e)throw new o("Invalid token specified: must be a string");r||(r={});const t=!0===r.header?0:1,a=e.split(".")[t];if("string"!==typeof a)throw new o("Invalid token specified: missing part #".concat(t+1));let c;try{c=n(a)}catch(s){throw new o("Invalid token specified: invalid base64 for part #".concat(t+1," (").concat(s.message,")"))}try{return JSON.parse(c)}catch(s){throw new o("Invalid token specified: invalid json for part #".concat(t+1," (").concat(s.message,")"))}}(e),t=Date.now()/1e3;return void 0!==r.exp&&r.exp<t}catch(r){return console.error("Error decoding token:",r),!0}};return(0,a.useEffect)((()=>{(async()=>{if(t===l.nm.SUCCESS||t===l.nm.FAILED)return;if(r&&h&&p&&e)return;if(!h||!p)return void u((0,l.UK)(l.nm.FAILED));if(k(h))try{u((0,i.qN)(!0));const e=await g.K.refreshToken(h,p);localStorage.setItem("access_token",e.accessToken),localStorage.setItem("refresh_token",e.refreshToken),g.K.getUserByEmail().then((e=>{const r=e;u((0,l.R9)({user:r})),u((0,l.ul)(!0))})).catch((e=>{console.error("Failed to get user by email",e),u((0,l.UK)(l.nm.FAILED))})).finally((()=>{u((0,i.qN)(!1))}))}catch(o){console.error("Error refreshing token",o),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("provider"),u((0,l.ni)()),u((0,i.qN)(!1)),u((0,l.UK)(l.nm.FAILED)),d(f._.user.homepage.root)}else u((0,i.qN)(!0)),g.K.getUserByEmail().then((e=>{const r=e;u((0,l.R9)({user:r})),u((0,l.ul)(!0))})).catch((e=>{console.error("Failed to get user by email",e),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("provider"),u((0,l.ni)()),u((0,l.UK)(l.nm.FAILED)),d(f._.user.homepage.root)})).finally((()=>{u((0,i.qN)(!1))}))})()}),[u,p,e,h,r,d,t]),(0,m.jsx)(s.j3,{})}}}]);