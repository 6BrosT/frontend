"use strict";(self.webpackChunkfrontend_app=self.webpackChunkfrontend_app||[]).push([[2402],{32952:(e,n,s)=>{s.d(n,{Z:()=>m});s(47313);var i=s(79536),t=s(6306),a=s(54045),o=s(99249),r=s(75975),l=s(78925),d=s(23885),c=s(75590),u=s(46417);function m(e){let{files:n=[],treeView:s=!0}=e;const{t:m,i18n:g}=(0,c.$G)(),h=async e=>{if(void 0===e)return;const s=n.find((n=>n.id===e));if(s)if(s.downloadUrl){const e=await fetch(s.downloadUrl),n=await e.blob();(0,l.saveAs)(n,s.name)}else console.error("File not found")};function _(e,n){const s=new Date(e);if(isNaN(s.getTime()))throw new Error("Invalid timestamp");const i={en:{AM:"AM",PM:"PM"},vi:{AM:"SA",PM:"CH"}},t=s.getUTCDate(),a={en:["January","February","March","April","May","June","July","August","September","October","November","December"],vi:["Th\xe1ng M\u1ed9t","Th\xe1ng Hai","Th\xe1ng Ba","Th\xe1ng T\u01b0","Th\xe1ng N\u0103m","Th\xe1ng S\xe1u","Th\xe1ng B\u1ea3y","Th\xe1ng T\xe1m","Th\xe1ng Ch\xedn","Th\xe1ng M\u01b0\u1eddi","Th\xe1ng M\u01b0\u1eddi M\u1ed9t","Th\xe1ng M\u01b0\u1eddi Hai"]}[n][s.getUTCMonth()],o=s.getUTCFullYear();let r=s.getUTCHours();const l=s.getUTCMinutes(),d=r>=12?i[n].PM:i[n].AM;r%=12,r=r||12;const c=l<10?"0"+l:l.toString();return"".concat(t," ").concat(a," ").concat(o,", ").concat(r,":").concat(c," ").concat(d)}return(0,u.jsx)(i.Z,{sx:{flexGrow:1},children:s?(0,u.jsx)(o.L,{"aria-label":"file system navigator",defaultCollapseIcon:(0,u.jsx)(t.Z,{}),defaultExpandIcon:(0,u.jsx)(a.Z,{}),children:0!==n.length&&(0,u.jsx)(r.k,{nodeId:"root",label:"Files",children:n.map(((e,n)=>(0,u.jsx)("div",{className:"thumbnail",children:(0,u.jsx)("a",{href:e.downloadUrl,style:{display:"block",wordBreak:"break-word",whiteSpace:"normal"},onClick:n=>{n.preventDefault(),h(e.id)},children:e.name},e.id)},n)))})}):(0,u.jsx)("div",{className:"thumbnail",children:n.map(((e,n)=>(0,u.jsxs)("div",{style:{display:"flex",gap:"15px"},children:[(0,u.jsx)("a",{href:e.downloadUrl,style:{display:"block",wordBreak:"break-word",whiteSpace:"normal",width:"50%"},onClick:n=>{n.preventDefault(),h(e.id)},children:e.name},e.id),(0,u.jsx)("p",{children:_(e.file.lastModified,"en"===d.ZP.language?"en":"vi")})]})))})})}},42402:(e,n,s)=>{s.r(n),s.d(n,{default:()=>F});var i=s(9019),t=s(79536),a=s(85281),o=s(47825),r=s(42832),l=s(66212),d=s(33223),c=s(90200),u=s(16977),m=s(37735),g=s(92556),h=s(99221),_=s(47313),p=s(58467),f=s(38556);const v={root:"styles_root__kbPeq",container:"styles_container__Lbkiq",mainContent:"styles_mainContent__vSLXd",formBody:"styles_formBody__xr1lk",drawerBody:"styles_drawerBody__-SHxX",drawerFieldContainer:"styles_drawerFieldContainer__uAvPX",breadcumpWrapper:"styles_breadcumpWrapper__Pd1sy",icArrow:"styles_icArrow__VyZc0",cursorPointer:"styles_cursorPointer__S4KS2",contentContainer:"styles_contentContainer__2f8oO",gradeContainer:"styles_gradeContainer__EvlOf",stickyBottom:"styles_stickyBottom__m1-ko"};var b=s(90469),y=s(32952),x=s(33256),w=s(65537),j=s(75948),C=s(19860),k=s(75590),Z=s(66010),S=s(65005);class A{static async handleResponse(e){if(e.status>=200&&e.status<300)return e.data;throw new Error("Unexpected response status: ".concat(e.status))}static handleError(e){var n,s,i,t,a,o;return console.error("API call failed",e),Promise.reject({code:(null===(n=e.response)||void 0===n||null===(s=n.data)||void 0===s?void 0:s.code)||503,status:(null===(i=e.response)||void 0===i||null===(t=i.data)||void 0===t?void 0:t.status)||"Service Unavailable",message:(null===(a=e.response)||void 0===a||null===(o=a.data)||void 0===o?void 0:o.message)||e.message})}static async createSubmissionGrade(e){try{const n=await this.apiClient.post("".concat(Z.b.COURSE.SUBMISSION_GRADE.DEFAULT),e);return this.handleResponse(n)}catch(n){return this.handleError(n)}}static async updateSubmissionGrade(e,n){try{const s=await this.apiClient.put("".concat(Z.b.COURSE.SUBMISSION_GRADE.DEFAULT,"/").concat(n),e);return this.handleResponse(s)}catch(s){return this.handleError(s)}}}A.apiClient=(0,S.Z)({baseURL:"https://api.codedynamite.click",isAuthorization:!0});var N=s(80007),I=s(28765),T=s(47477),M=s(46417);function F(){var e,n,s,Z,S,F,U,E,D,L,B,G,P;const{t:O}=(0,k.$G)(),{width:H}=(0,f.Z)(),R=(0,p.s0)(),[J,z]=((0,C.Z)(),_.useState(!0)),[V,q]=_.useState([O("common_submission_type_file"),O("common_submission_type_online_text")]),[K,W]=_.useState(""),[X,$]=_.useState(""),{courseId:Q,assignmentId:Y,submissionId:ee}=(0,p.UO)(),[ne,se]=_.useState(null!==(e=null===ee||void 0===ee?void 0:ee.toString())&&void 0!==e?e:""),ie=(0,w.v9)((e=>e.submissionAssignment)),te=(0,w.v9)((e=>e.assignment)),ae=(0,w.I0)();_.useEffect((()=>{z(!(H<1080))}),[H]);const oe=_.useRef(null),{height:re}=(0,T.Z)({ref:oe}),le=async function(){var e;let n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const s=null===(e=ie.submissionAssignments.find((e=>e.id===ne)))||void 0===e?void 0:e.submissionGrade;if(s){var i;const e={grade:Number(K),timeModified:(new Date).toISOString()};await A.updateSubmissionGrade(e,null!==(i=s.id)&&void 0!==i?i:"");const n={feedback:X};await x.J.update(n,null!==ee&&void 0!==ee?ee:"")}else{const e={submissionAssignmentId:null!==ee&&void 0!==ee?ee:"",grade:Number(K),timeCreated:(new Date).toISOString(),timeModified:(new Date).toISOString()};await de(e);const n={isGraded:!0,feedback:X};await x.J.update(n,null!==ee&&void 0!==ee?ee:"")}n&&ue()},de=async e=>{try{const n=await A.createSubmissionGrade(e);if(n)return n}catch(n){console.error("Failed to create submission grade",n)}},ce=(0,_.useCallback)((async e=>{ae((0,j.K4)(!0));try{const n=await x.J.getSubmissionAssignmentByAssignmentId(e);console.log(n),ae((0,j.q5)(n))}catch(n){console.error("Failed to fetch submission assignment",n)}finally{ae((0,j.K4)(!1))}}),[ae]);(0,_.useEffect)((()=>{Y&&ce(Y)}),[Y,ce]),(0,_.useEffect)((()=>{ne&&R(b._.lecturer.assignment.grading.replace(":assignmentId",null!==Y&&void 0!==Y?Y:"").replace(":courseId",null!==Q&&void 0!==Q?Q:"").replace(":submissionId",ne))}),[ne,Y,Q,R]),(0,_.useEffect)((()=>{(async()=>{var e,n,s;const i=await x.J.getSubmissionAssignmentById(ne),t=null!==(e=null===(n=i.submissionGrade)||void 0===n?void 0:n.grade)&&void 0!==e?e:-1;W(-1===t?"":t.toString()),$(null!==(s=null===i||void 0===i?void 0:i.feedback)&&void 0!==s?s:"")})()}),[ne]);const ue=()=>{const e=(ie.submissionAssignments.findIndex((e=>e.id===ne))+1)%ie.submissionAssignments.length,n=ie.submissionAssignments[e].id;se(n)};function me(e,n,s){const i=(new DOMParser).parseFromString(e,"text/html"),t=i.getElementsByTagName("img");for(let o of t)o.classList.add(n);const a=i.createElement("style");return a.textContent=s,i.head.appendChild(a),i.documentElement.outerHTML}const ge="\n.custom-class {\n    max-width: 100%;\n    height: auto;\n}\n",he=null===(n=ie.submissionAssignments.find((e=>e.id===ne)))||void 0===n?void 0:n.content;return(0,M.jsxs)(i.ZP,{className:v.root,children:[(0,M.jsx)(c.Z,{ref:oe}),ie.isLoading?(0,M.jsx)(t.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",gap:"10px"},children:(0,M.jsx)(a.Z,{})}):(0,M.jsx)(M.Fragment,{children:(0,M.jsxs)(t.Z,{className:v.contentContainer,sx:{marginTop:"".concat(re,"px")},children:[(0,M.jsx)(o.Z,{sx:{padding:"0",display:"flex",justifyContent:"flex-start"},children:(0,M.jsx)(I.Z,{breadCrumbData:[{navLink:b._.lecturer.course.management,label:"Qu\u1ea3n l\xfd kho\xe1 h\u1ecdc"},{navLink:b._.lecturer.course.information.replace(":courseId",null!==Q&&void 0!==Q?Q:""),label:"CS202 - Nh\u1eadp m\xf4n l\u1eadp tr\xecnh"},{navLink:b._.lecturer.course.assignment.replace(":courseId",null!==Q&&void 0!==Q?Q:""),label:"Danh s\xe1ch b\xe0i t\u1eadp"},{navLink:b._.lecturer.assignment.detail.replace(":assignmentId",null!==Y&&void 0!==Y?Y:"").replace(":courseId",null!==Q&&void 0!==Q?Q:""),label:null===(s=ie.submissionAssignments[0])||void 0===s?void 0:s.assignmentName}],lastBreadCrumbLabel:"\u0110\xe1nh gi\xe1"})})," ",(0,M.jsxs)(o.Z,{sx:{backgroundColor:"white",marginTop:"5px",height:"fit-content",padding:"16px"},className:v.gradeContainer,children:[(0,M.jsx)(h.Z,{"translation-key":"common_student",children:O("common_student")}),(0,M.jsx)(m.Z,{labelId:"select-assignment-submission-student-label",value:ne,onHandleChange:e=>se(e),items:ie.submissionAssignments.map((e=>({value:e.id,label:e.user.fullName,customNode:(0,M.jsxs)(t.Z,{children:[(0,M.jsx)(h.Z,{fontWeight:"500",children:e.user.fullName}),(0,M.jsx)(N.Z,{colorname:"--gray-500",children:e.user.email})]})}))),backgroundColor:"var(--gray-2)"}),(0,M.jsxs)(t.Z,{className:v.drawerFieldContainer,children:[(0,M.jsx)(h.Z,{"translation-key":"course_lecturer_grading_assignment_type",children:O("course_lecturer_grading_assignment_type")}),(0,M.jsx)(r.Z,{"translation-key":["common_submission_type_file","common_submission_type_online_text"],direction:"row",spacing:1,children:V.map((e=>(0,M.jsx)(l.Z,{label:e})))})]}),"BOTH"===(null===(Z=te.assignmentDetails)||void 0===Z?void 0:Z.type)?(0,M.jsxs)(M.Fragment,{children:[(0,M.jsxs)(t.Z,{className:v.drawerFieldContainer,"translation-key":"no_data",children:[(0,M.jsx)(h.Z,{"translation-key":"course_lecturer_submission_online_text",children:O("course_lecturer_submission_online_text")}),(0,M.jsx)("div",{dangerouslySetInnerHTML:{__html:he?me(he,"custom-class",ge):'<span style="color: red;">'.concat(O("no_data"),"</span>")}})]}),(0,M.jsxs)(t.Z,{className:v.drawerFieldContainer,"translation-key":"no_data",children:[(0,M.jsx)(h.Z,{"translation-key":"course_lecturer_submission_file",children:O("course_lecturer_submission_file")}),0!=(null===(S=ie.submissionAssignments.find((e=>e.id===ne)))||void 0===S?void 0:S.submissionAssignmentFiles.length)?(0,M.jsx)(y.Z,{files:null!==(F=null===(U=ie.submissionAssignments.find((e=>e.id===ne)))||void 0===U||null===(E=U.submissionAssignmentFiles)||void 0===E?void 0:E.map((e=>{let n=new File([""],e.fileName,{lastModified:new Date(e.timemodified).getTime()});return{id:e.id,name:e.fileName,downloadUrl:e.fileUrl,size:e.fileSize,type:e.mimetype,file:n}})))&&void 0!==F?F:[],treeView:!1}):(0,M.jsx)("span",{style:{color:"red"},children:O("no_data")})]})]}):"FILE"===(null===(D=te.assignmentDetails)||void 0===D?void 0:D.type)?(0,M.jsxs)(t.Z,{className:v.drawerFieldContainer,"translation-key":"no_data",children:[(0,M.jsx)(h.Z,{"translation-key":"course_lecturer_submission_file",children:O("course_lecturer_submission_file")}),0!=(null===(L=ie.submissionAssignments.find((e=>e.id===ne)))||void 0===L?void 0:L.submissionAssignmentFiles.length)?(0,M.jsx)(y.Z,{files:null!==(B=null===(G=ie.submissionAssignments.find((e=>e.id===ne)))||void 0===G||null===(P=G.submissionAssignmentFiles)||void 0===P?void 0:P.map((e=>{let n=new File([""],e.fileName,{lastModified:new Date(e.timemodified).getTime()});return{id:e.id,name:e.fileName,downloadUrl:e.fileUrl,size:e.fileSize,type:e.mimetype,file:n}})))&&void 0!==B?B:[],treeView:!1}):(0,M.jsx)("span",{style:{color:"red"},children:O("no_data")})]}):(0,M.jsxs)(t.Z,{className:v.drawerFieldContainer,"translation-key":"no_data",children:[(0,M.jsx)(h.Z,{"translation-key":"course_lecturer_submission_online_text",children:O("course_lecturer_submission_online_text")}),(0,M.jsx)("div",{dangerouslySetInnerHTML:{__html:he?me(he,"custom-class",ge):'<span style="color: red;">'.concat(O("no_data"),"</span>")}})]}),(0,M.jsxs)(t.Z,{className:v.drawerFieldContainer,children:[(0,M.jsx)(h.Z,{"translation-key":"course_lecturer_score_on_range",children:O("course_lecturer_score_on_range",{range:100})}),(0,M.jsx)(u.Z,{type:"number",value:K,onChange:e=>W(e.target.value),placeholder:"Nh\u1eadp \u0111i\u1ec3m",backgroundColor:"white"})]}),(0,M.jsxs)(t.Z,{className:v.feedbackContainer,children:[(0,M.jsx)(h.Z,{"translation-key":"course_lecturer_grade_comment",children:O("course_lecturer_grade_comment")}),(0,M.jsx)(t.Z,{className:v.textEditor,children:(0,M.jsx)(g.Z,{style:{marginTop:"10px",height:"300px"},value:X,onChange:$})})]})]})]})}),(0,M.jsxs)(t.Z,{className:v.stickyBottom,children:[(0,M.jsx)(d.Z,{variant:"contained",color:"primary",className:v.btnGrade,onClick:()=>le(),children:"L\u01b0u thay \u0111\u1ed5i"}),(0,M.jsx)(d.Z,{variant:"contained",color:"primary",className:v.btnGrade,onClick:()=>le(!0),children:"L\u01b0u v\xe0 ti\u1ebfp t\u1ee5c"})]})]})}}}]);